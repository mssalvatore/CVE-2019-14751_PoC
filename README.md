# CVE-2019-14751_PoC
A Proof of Concept for CVE-2019-14751


## Vulnerability Description

NLTK Downloader before version 3.5 is vulnerable to a directory traversal,
allowing attackers to write arbitrary files via a ../ (dot dot slash)
in an NLTK package (ZIP archive) that is mishandled during extraction.

For more information see https://salvatoresecurity.com.


## Steps to Reproduce

1. Place the attached index.xml and zip-slip.zip in a directory where they
will be served by a web server. Adjust permissions to allow the files to be
served.

1. Run NLTK Downloader
    ```python
    $> python3
    >>> import nltk
    >>> nltk.download()
    ```

1. Change the value in the "Server Index" field to point to the index.xml
   from step 1

1. Click "Download" to install the malicious package

1. Check for the existence of "/tmp/evil.txt".
    ```
    $> cat /tmp/evil.txt
    This is an evil file
    $>
    ```


## Remediation

This vulnerability is fixed in NLTK version 3.5 and later. The following commit
resolves the vulnerability:
https://github.com/nltk/nltk/commit/fb7c5bdbfdd9013672ed8d5d226b2f62a9e353d7
